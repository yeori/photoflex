{"version":3,"sources":["webpack://photoflex/webpack/universalModuleDefinition","webpack://photoflex/./src/photoflex.scss","webpack://photoflex/./node_modules/css-loader/dist/runtime/api.js","webpack://photoflex/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://photoflex/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://photoflex/webpack/bootstrap","webpack://photoflex/webpack/runtime/compat get default export","webpack://photoflex/webpack/runtime/define property getters","webpack://photoflex/webpack/runtime/hasOwnProperty shorthand","webpack://photoflex/webpack/runtime/make namespace object","webpack://photoflex/./src/dom.js","webpack://photoflex/./src/dnd.js","webpack://photoflex/./src/canvas.js","webpack://photoflex/./src/selection.js","webpack://photoflex/./src/rangebox.js","webpack://photoflex/./src/photoflex.scss?cae9","webpack://photoflex/./src/index.js"],"names":["root","factory","exports","module","define","amd","self","___CSS_LOADER_EXPORT___","push","id","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","_i","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","value","err","_iterableToArrayLimit","o","minLen","n","Object","prototype","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","api","domAPI","update","newObj","remove","lastIdentifiers","newList","newLastIdentifiers","_index","splice","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","createElement","setAttributes","attributes","nonce","setAttribute","insertStyleElement","removeAttribute","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","d","a","definition","key","defineProperty","enumerable","get","prop","hasOwnProperty","r","toStringTag","Attr","attrExpression","expression","charAt","substring","el","isId","isClass","classList","add","EMPTY_SET","Set","EventBus","callbacks","Map","eventName","callback","callbackList","set","payload","forEach","cb","console","log","closest","elem","selector","nodeType","parentElement","nodeTye","nodeName","parseAttr","split","val","trim","filter","createEl","tagName","tag","registerEvent","addEventListener","stopPropagation","attr","span","innerHTML","attrs","button","imgUrl","img","Promise","resolve","width","height","src","styles","converters","keys","template","params","t","text","replaceAll","virtualElem","firstElementChild","cssSelector","found","matches","attrList","v","dataset","parseInt","DUMMY_DRAG_LISTENER","convToMouseEvent","te","touch","touches","type","changedTouches","clientX","clientY","layerX","layerY","offsetX","offsetY","pageX","pageY","screenX","screenY","mousedown","dnd","ctx","handler","accept","dragging","originalEvent","sx","sy","dx","dy","beforeDrag","mousemove","preventDefault","mouseup","cursor","afterDrag","clearTouchTimer","clearTimeout","touchTimer","Dnd","$$","dom","setTimeout","touchstart","touchmove","passive","touchend","fitByOriginalSize","canvas","ratio","meta","canvasWidth","canvasHeight","cvs","x","y","image","scaling","cover","scale","imageW","imageH","contain","none","capturing","viewport","rect","imgData","getImageData","copyCanvas","getContext","putImageData","toDataURL","scaledRect","capture","Math","min","DndHandler","vx","vy","canvasEl","repaint","ImageSource","origin","originCtx","drawImage","wrapperEl","config","eventBus","parentEl","injectCanvas","on","fitMode","emit","clearRect","captureOn","clearCanvas","renderImage","offsetWidth","boxEl","drawSize","selection","fn","w","h","pos","parent","moveHandler","offsetLeft","offsetTop","offsetHeight","left","max","top","ResizeHandler","sw","sh","btnResize","editing","prepareEl","setVisible","resizeDnd","vp","range","ranges","visible","display","div","sizeDiv","sizeEl","sizeText","areaBox","areaEl","areaText","wrapper","bus","renderOptions","ul","replaceChildren","option","idx","li","active","_ranges","activeIndex","findIndex","save","captureFormatter","Image","dataUrl","PhotoFlex","size","rangebox","rootWrapper","getConfig","mergeSelection","rectToCaputure","format","dataURL","copyImageAt","comma","indexOf","sizeInRealPic","formatMode","setConfig","fileSource","file","reader","FileReader","readAsDataURL","then","fileMeta","setImage","init","userConfig","assign","validate","alert","toInt","activeRange","canvasWrapper","Canvas","Selection","instance"],"mappings":"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","file":"photoflex.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"photoflex\"] = factory();\n\telse\n\t\troot[\"photoflex\"] = factory();\n})(self, function() {\nreturn ","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"[data-photoflex-container]{padding:30px;position:relative;text-align:center;background-color:#ececec}[data-photoflex-container] .canvas-wrapper{display:inline-block;background-color:#fff;line-height:1;box-shadow:rgba(14,30,37,.12) 0px 2px 4px 0px,rgba(14,30,37,.32) 0px 2px 16px 0px;position:relative}[data-photoflex-container] .canvas-wrapper canvas{display:block;cursor:all-scroll}[data-photoflex-container] .canvas-wrapper .selection{position:absolute;width:300px;height:300px;outline:1px solid transparent;z-index:10;cursor:pointer;display:flex;align-items:center;justify-content:center}[data-photoflex-container] .canvas-wrapper .selection.viewport{border-color:red;outline-color:red}[data-photoflex-container] .canvas-wrapper .selection.viewport .box{background-color:red;border-color:inherit}[data-photoflex-container] .canvas-wrapper .selection.viewport .btn-icon{background-color:red}[data-photoflex-container] .canvas-wrapper .selection.image{border-color:#23ae3a;outline-color:#23ae3a}[data-photoflex-container] .canvas-wrapper .selection.image .box{background-color:#23ae3a;border-color:inherit}[data-photoflex-container] .canvas-wrapper .selection.image .btn-icon{background-color:#23ae3a}[data-photoflex-container] .canvas-wrapper .selection button{margin:0}[data-photoflex-container] .canvas-wrapper .selection .btn-icon{border:none;line-height:1;padding:4px;border-radius:50px;color:#ccc;opacity:.7;display:none}[data-photoflex-container] .canvas-wrapper .selection .btn-icon:hover{opacity:.8}[data-photoflex-container] .canvas-wrapper .selection .btn-move{position:absolute;top:0;left:0;transform:translateX(-110%);display:none;cursor:all-scroll}[data-photoflex-container] .canvas-wrapper .selection .btn-resizer{position:absolute;bottom:0;left:100%;cursor:se-resize;transform:translate(10%, 10%)}[data-photoflex-container] .canvas-wrapper .selection .btn-resizer>svg{transform:rotate(-45deg)}[data-photoflex-container] .canvas-wrapper .selection .size-box{position:absolute;top:100%;left:-1px;box-sizing:border-box;display:flex}[data-photoflex-container] .canvas-wrapper .selection .size-box .size-text{user-select:none;font-size:12px;padding:8px;border:1px solid inherit;color:#fff;white-space:nowrap}[data-photoflex-container] .canvas-wrapper .selection .size-box .btn-range-lock{background-color:transparent;border:none;background-color:inherit}[data-photoflex-container] .canvas-wrapper .selection .area-box{position:absolute;top:0;right:-1px;transform:translate(0, -100%);box-sizing:border-box;display:flex}[data-photoflex-container] .canvas-wrapper .selection .area-box .area-text{user-select:none;font-size:12px;padding:8px;background-color:inherit;border:1px solid inherit;color:#fff;white-space:nowrap}[data-photoflex-container] .canvas-wrapper .selection.editing .btn-icon{display:flex;color:#fff}[data-photoflex-container] .range-bg{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background-color:#0000004d;font-size:.85rem;z-index:100}[data-photoflex-container] .range-bg .range-box{background-color:#fff;min-width:260px;text-align:left}[data-photoflex-container] .range-bg .range-box>h3{margin:0;padding:10px 20px}[data-photoflex-container] .range-bg .range-box .range-list{list-style:none;padding:0;margin:0;cursor:pointer}[data-photoflex-container] .range-bg .range-box .range-list>li{padding:5px 20px}[data-photoflex-container] .range-bg .range-box .range-list>li.active{background-color:#cff4ff}[data-photoflex-container] .range-bg .range-box .range-list>li:hover{background-color:#f0f8ff}[data-photoflex-container] .range-bg .range-box .range-input{padding:0px 20px 10px;display:flex;border-bottom:1px solid #cdcdcd}[data-photoflex-container] .range-bg .range-box .range-input>input{margin-right:4px}[data-photoflex-container] .range-bg .range-box .footer{padding:10px 20px;border-top:1px solid #cdcdcd;text-align:right}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/photoflex.scss\"],\"names\":[],\"mappings\":\"AAAA,2BACE,YAAA,CACA,iBAAA,CACA,iBAAA,CACA,wBAAA,CAEA,2CACE,oBAAA,CACA,qBAAA,CACA,aAAA,CACA,iFAAA,CAEA,iBAAA,CACA,kDACE,aAAA,CACA,iBAAA,CAEF,sDACE,iBAAA,CACA,WAAA,CACA,YAAA,CACA,6BAAA,CACA,UAAA,CACA,cAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,+DACE,gBAAA,CACA,iBAAA,CACA,oEACE,oBAAA,CACA,oBAAA,CAEF,yEACE,oBAAA,CAGJ,4DACE,oBAAA,CACA,qBAAA,CACA,iEACE,wBAAA,CACA,oBAAA,CAEF,sEACE,wBAAA,CAGJ,6DACE,QAAA,CAEF,gEACE,WAAA,CACA,aAAA,CACA,WAAA,CACA,kBAAA,CACA,UAAA,CACA,UAAA,CACA,YAAA,CACA,sEACE,UAAA,CAGJ,gEACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,2BAAA,CACA,YAAA,CACA,iBAAA,CAEF,mEACE,iBAAA,CACA,QAAA,CACA,SAAA,CACA,gBAAA,CACA,6BAAA,CACA,uEACE,wBAAA,CAGJ,gEACE,iBAAA,CACA,QAAA,CACA,SAAA,CACA,qBAAA,CACA,YAAA,CAGA,2EACE,gBAAA,CACA,cAAA,CACA,WAAA,CACA,wBAAA,CACA,UAAA,CACA,kBAAA,CAEF,gFACE,4BAAA,CACA,WAAA,CACA,wBAAA,CAGJ,gEACE,iBAAA,CACA,KAAA,CACA,UAAA,CACA,6BAAA,CACA,qBAAA,CACA,YAAA,CACA,2EACE,gBAAA,CACA,cAAA,CACA,WAAA,CACA,wBAAA,CACA,wBAAA,CACA,UAAA,CACA,kBAAA,CAIF,wEACE,YAAA,CACA,UAAA,CAKR,qCACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,QAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,0BAAA,CACA,gBAAA,CACA,WAAA,CACA,gDACE,qBAAA,CACA,eAAA,CACA,eAAA,CACA,mDACE,QAAA,CACA,iBAAA,CAEF,4DACE,eAAA,CACA,SAAA,CACA,QAAA,CACA,cAAA,CACA,+DACE,gBAAA,CACA,sEACE,wBAAA,CAEF,qEACE,wBAAA,CAIN,6DACE,qBAAA,CACA,YAAA,CACA,+BAAA,CACA,mEACE,gBAAA,CAGJ,wDACE,iBAAA,CACA,4BAAA,CACA,gBAAA\",\"sourcesContent\":[\"[data-photoflex-container] {\\n  padding: 30px;\\n  position: relative;\\n  text-align: center;\\n  background-color: #ececec;\\n\\n  .canvas-wrapper {\\n    display: inline-block;\\n    background-color: white;\\n    line-height: 1;\\n    box-shadow: rgba(14, 30, 37, 0.12) 0px 2px 4px 0px,\\n      rgba(14, 30, 37, 0.32) 0px 2px 16px 0px;\\n    position: relative;\\n    canvas {\\n      display: block;\\n      cursor: all-scroll;\\n    }\\n    .selection {\\n      position: absolute;\\n      width: 300px;\\n      height: 300px;\\n      outline: 1px solid transparent;\\n      z-index: 10;\\n      cursor: pointer;\\n      display: flex;\\n      align-items: center;\\n      justify-content: center;\\n      &.viewport {\\n        border-color: red;\\n        outline-color: red;\\n        .box {\\n          background-color: red;\\n          border-color: inherit;\\n        }\\n        .btn-icon {\\n          background-color: red;\\n        }\\n      }\\n      &.image {\\n        border-color: #23ae3a;\\n        outline-color: #23ae3a;\\n        .box {\\n          background-color: #23ae3a;\\n          border-color: inherit;\\n        }\\n        .btn-icon {\\n          background-color: #23ae3a;\\n        }\\n      }\\n      button {\\n        margin: 0;\\n      }\\n      .btn-icon {\\n        border: none;\\n        line-height: 1;\\n        padding: 4px;\\n        border-radius: 50px;\\n        color: #ccc;\\n        opacity: 0.7;\\n        display: none;\\n        &:hover {\\n          opacity: 0.8;\\n        }\\n      }\\n      .btn-move {\\n        position: absolute;\\n        top: 0;\\n        left: 0;\\n        transform: translateX(-110%);\\n        display: none;\\n        cursor: all-scroll;\\n      }\\n      .btn-resizer {\\n        position: absolute;\\n        bottom: 0;\\n        left: 100%;\\n        cursor: se-resize;\\n        transform: translate(10%, 10%);\\n        & > svg {\\n          transform: rotate(-45deg);\\n        }\\n      }\\n      .size-box {\\n        position: absolute;\\n        top: 100%;\\n        left: -1px;\\n        box-sizing: border-box;\\n        display: flex;\\n        // background-color: red;\\n        // border-color: red;\\n        .size-text {\\n          user-select: none;\\n          font-size: 12px;\\n          padding: 8px;\\n          border: 1px solid inherit;\\n          color: white;\\n          white-space: nowrap;\\n        }\\n        .btn-range-lock {\\n          background-color: transparent;\\n          border: none;\\n          background-color: inherit;\\n        }\\n      }\\n      .area-box {\\n        position: absolute;\\n        top: 0;\\n        right: -1px;\\n        transform: translate(0, -100%);\\n        box-sizing: border-box;\\n        display: flex;\\n        .area-text {\\n          user-select: none;\\n          font-size: 12px;\\n          padding: 8px;\\n          background-color: inherit;\\n          border: 1px solid inherit;\\n          color: white;\\n          white-space: nowrap;\\n        }\\n      }\\n      &.editing {\\n        .btn-icon {\\n          display: flex;\\n          color: white;\\n        }\\n      }\\n    }\\n  }\\n  .range-bg {\\n    position: absolute;\\n    top: 0;\\n    left: 0;\\n    right: 0;\\n    bottom: 0;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    background-color: #0000004d;\\n    font-size: 0.85rem;\\n    z-index: 100;\\n    .range-box {\\n      background-color: white;\\n      min-width: 260px;\\n      text-align: left;\\n      & > h3 {\\n        margin: 0;\\n        padding: 10px 20px;\\n      }\\n      .range-list {\\n        list-style: none;\\n        padding: 0;\\n        margin: 0;\\n        cursor: pointer;\\n        & > li {\\n          padding: 5px 20px;\\n          &.active {\\n            background-color: #cff4ff;\\n          }\\n          &:hover {\\n            background-color: aliceblue;\\n          }\\n        }\\n      }\\n      .range-input {\\n        padding: 0px 20px 10px;\\n        display: flex;\\n        border-bottom: 1px solid #cdcdcd;\\n        & > input {\\n          margin-right: 4px;\\n        }\\n      }\\n      .footer {\\n        padding: 10px 20px;\\n        border-top: 1px solid #cdcdcd;\\n        text-align: right;\\n      }\\n    }\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n/* istanbul ignore next  */\n\n\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n\n  target.appendChild(style);\n}\n\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var style = document.createElement(\"style\");\n  options.setAttributes(style, options.attributes);\n  options.insert(style);\n  return style;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(style) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n  if (nonce) {\n    style.setAttribute(\"nonce\", nonce);\n  }\n}\n\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute(\"media\", media);\n  } else {\n    style.removeAttribute(\"media\");\n  }\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, style);\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var style = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(style, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(style);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, style) {\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/* eslint-disable max-classes-per-file */\nclass Attr {\n  constructor(attrExpression) {\n    this.expression = attrExpression;\n  }\n\n  get isClass() {\n    return this.expression.charAt(0) === '.';\n  }\n\n  get isId() {\n    return this.expression.charAt(0) === '#';\n  }\n\n  get value() {\n    return this.expression.substring(1);\n  }\n\n  setAttribute(el) {\n    if (this.isId) {\n      el.setAttribute('id', this.value);\n    } else if (this.isClass) {\n      el.classList.add(this.value);\n    } else {\n      throw new Error(`neither id nor class : [${this.expression}]`);\n    }\n  }\n}\nconst EMPTY_SET = new Set();\nclass EventBus {\n  constructor() {\n    this.callbacks = new Map();\n  }\n\n  on(eventName, callback) {\n    let callbackList = this.callbacks.get(eventName);\n    if (!callbackList) {\n      callbackList = new Set();\n      this.callbacks.set(eventName, callbackList);\n    }\n    callbackList.add(callback);\n  }\n\n  emit(eventName, payload) {\n    const callbackList = this.callbacks.get(eventName) || EMPTY_SET;\n    callbackList.forEach((cb) => {\n      try {\n        cb(payload);\n      } catch (e) {\n        console.log(e);\n      }\n    });\n  }\n}\n\nconst closest = (elem, selector) => {\n  if (elem.nodeType === 1) {\n    return elem.closest(selector);\n  }\n  if (elem.nodeType === 3) {\n    return elem.parentElement.closest(selector);\n  }\n  throw new Error(`node type ${elem.nodeTye}, tag(${elem.nodeName})`);\n};\n\nconst parseAttr = (expression) => {\n  const attr = expression || '';\n  return attr\n    .split(' ')\n    .map((val) => val.trim())\n    .filter((val) => val.length > 0);\n};\nconst createEl = (tagName, attributes) => {\n  const tag = document.createElement(tagName);\n  attributes.forEach((value) => {\n    const attr = new Attr(value);\n    attr.setAttribute(tag);\n  });\n  return tag;\n};\nconst tag = {\n  span: (attr, content) => {\n    const span = createEl('span', parseAttr(attr));\n    if (content) {\n      span.innerHTML = content;\n    }\n    return span;\n  },\n  iconButton: (attrs, content) => {\n    const button = createEl('BUTTON', parseAttr(attrs));\n    button.innerHTML = content;\n    return button;\n  },\n  img: (imgUrl) => {\n    const img = document.createElement('img');\n    return new Promise((resolve) => {\n      img.addEventListener('load', () => {\n        // img.crossOrigin = 'Anonymous';\n        resolve({ img, width: 600, height: 600 });\n      });\n      img.src = imgUrl;\n    });\n  },\n  div: (attr) => createEl('DIV', parseAttr(attr)),\n  canvas: (attr) => createEl('CANVAS', parseAttr(attr))\n};\n\nconst imageSize = (imgUrl) => {\n  const xhr = new XMLHttpRequest();\n  xhr.open('HEAD', imgUrl, true);\n  xhr.onreadystatechange = () => {\n    if (xhr.readyState === xhr.DONE) {\n      console.log(xhr.getResponseHeader('Content-Length'));\n    }\n  };\n  xhr.send();\n};\n\nconst fileToImage = (file) => {\n  const reader = new FileReader();\n  return new Promise((resolve) => {\n    reader.addEventListener('load', () => {\n      const img = document.createElement('img');\n      img.src = reader.result;\n      resolve({ file, img });\n    });\n    reader.readAsDataURL(file);\n  });\n};\n\nconst registerEvent = (target, eventName, callback, options) => {\n  const el = target || window;\n  el.addEventListener(eventName, callback, options);\n};\n\nconst data = {\n  int: (el, attrList) => {\n    const d = {};\n    attrList.forEach((key) => {\n      const v = el.dataset[key];\n      d[key] = parseInt(v, 10);\n    });\n    return d;\n  }\n};\nconst stopPropagation = (e) => e.stopPropagation();\nconst event = {\n  createEventBus: () => new EventBus(),\n  consume: (target, eventName) => {\n    target.addEventListener(eventName, stopPropagation);\n  },\n  mousedown: (callback, target, options) => {\n    registerEvent(target, 'mousedown', callback, options);\n  },\n  mousemove: (callback, target, options) => {\n    registerEvent(target, 'mousemove', callback, options);\n  },\n  mouseup: (callback, target, options) => {\n    registerEvent(target, 'mouseup', callback, options);\n  },\n  touchstart: (callback, target, options) => {\n    registerEvent(target, 'touchstart', callback, options);\n  },\n  touchmove: (callback, target, options) => {\n    registerEvent(target, 'touchmove', callback, options);\n  },\n  touchend: (callback, target, options) => {\n    registerEvent(target, 'touchend', callback, options);\n  },\n  click: (target, callback, options) => {\n    registerEvent(target, 'click', callback, options);\n  }\n};\nconst css = (el, styles) => {\n  const converters = {\n    width: (val) => {\n      const type = typeof val;\n      return type === 'number' ? `${val}px` : val;\n    }\n  };\n  converters.height = converters.width;\n\n  Object.keys(styles).forEach((key) => {\n    const fn = converters[key] || ((val) => val);\n    const value = fn(styles[key]);\n    // eslint-disable-next-line no-param-reassign\n    el.style[key] = value;\n  });\n};\nconst parseTemplate = (template, params) => {\n  let t = template;\n  Object.keys(params).forEach((key) => {\n    const text = '@' + key;\n    const value = params[key];\n    t = t.replaceAll(text, value);\n  });\n  const virtualElem = document.createElement('template');\n  virtualElem.innerHTML = t;\n  return virtualElem.content.firstElementChild;\n  // return virtualDiv.firstElementChild;\n};\nconst findOne = (el, cssSelector) => el.querySelector(cssSelector);\nconst is = (el, cssSelector, callback) => {\n  const found = el.matches(cssSelector);\n  if (found) {\n    callback(el);\n    return found;\n  }\n  const elem = closest(el, cssSelector);\n  if (elem) {\n    callback(elem);\n    return true;\n  }\n  return false;\n};\nexport default {\n  tag,\n  closest,\n  imageSize,\n  fileToImage,\n  event,\n  css,\n  parseTemplate,\n  findOne,\n  is,\n  data\n};\n","import dom from './dom';\n/* eslint-disable no-param-reassign */\nconst DUMMY_DRAG_LISTENER = () => {};\n\nconst convToMouseEvent = (te) => {\n  let touch = te.touches[0];\n  if (te.type === 'touchend') {\n    // eslint-disable-next-line prefer-destructuring\n    touch = te.changedTouches[0];\n  }\n  te.clientX = touch.clientX;\n  te.clientY = touch.clientY;\n  te.layerX = 0;\n  te.layerY = 0;\n  te.offsetX = 0;\n  te.offsetY = 0;\n  te.pageX = touch.pageX;\n  te.pageY = touch.pageY;\n  te.screenX = touch.screenX;\n  te.screenY = touch.screenY;\n};\n\nconst mousedown = (dnd, e) => {\n  const { ctx } = dnd;\n  if (!dnd.handler.accept(e.target)) {\n    return;\n  }\n  // document.querySelector('body').style.cursor = 'e-resize'\n  ctx.dragging = {\n    originalEvent: e,\n    sx: e.pageX,\n    sy: e.pageY,\n    dx: 0,\n    dy: 0\n  };\n  dnd.beforeDrag(ctx.dragging, ctx.payload);\n};\nconst mousemove = (dnd, e) => {\n  const { ctx } = dnd;\n  if (ctx.dragging) {\n    e.preventDefault();\n    ctx.originalEvent = e;\n    ctx.originalEvent = e;\n    ctx.dragging.dx = e.pageX - ctx.dragging.sx;\n    ctx.dragging.dy = e.pageY - ctx.dragging.sy;\n    dnd.dragging(ctx.dragging, ctx.payload);\n  }\n};\nconst mouseup = (dnd, e) => {\n  // clearTimeout(ctx.touchTimer)\n  // ctx.touchTimer = null\n  const { ctx } = dnd;\n  try {\n    if (ctx.dragging) {\n      ctx.originalEvent = e;\n      document.querySelector('body').style.cursor = '';\n      dnd.afterDrag(ctx.dragging, ctx.payload);\n    }\n  } catch (err) {\n    console.log('[DND error]', err);\n  } finally {\n    ctx.dragging = null;\n  }\n};\nconst clearTouchTimer = (ctx) => {\n  clearTimeout(ctx.touchTimer);\n  ctx.touchTimer = null;\n};\nconst touchstart = (dnd, e) => {\n  const { ctx } = dnd;\n  ctx.touchTimer = setTimeout(() => {\n    convToMouseEvent(e);\n    mousedown(dnd, e);\n  }, 100);\n};\nconst touchmove = (dnd, e) => {\n  const { ctx } = dnd;\n  clearTouchTimer(ctx);\n  convToMouseEvent(e);\n  mousemove(dnd, e);\n};\nconst touchend = (dnd, e) => {\n  const { ctx } = dnd;\n  clearTouchTimer(ctx);\n  convToMouseEvent(e);\n  mouseup(dnd, e);\n};\n\nclass Dnd {\n  constructor(handler, payload) {\n    this.$$ = {};\n    this.ctx = {\n      payload,\n      dragging: null\n    };\n    this.handler = handler;\n    this.beforeDrag = handler.beforeDrag || DUMMY_DRAG_LISTENER;\n    this.dragging = handler.dragging || DUMMY_DRAG_LISTENER;\n    this.afterDrag = handler.afterDrag || DUMMY_DRAG_LISTENER;\n    dom.event.mousedown((e) => mousedown(this, e), window);\n    dom.event.mousemove((e) => mousemove(this, e), window);\n    dom.event.mouseup((e) => mouseup(this, e), window);\n    dom.event.touchstart((e) => touchstart(this, e), window);\n    dom.event.touchmove((e) => touchmove(this, e), window, {\n      passive: false\n    });\n    dom.event.touchend((e) => touchend(this, e), window);\n  }\n}\nexport { Dnd };\nexport default { Dnd };\n","import { Dnd } from './dnd';\nimport dom from './dom';\n\nconst resolveWidth = (parentEl) => parentEl.offsetWidth;\n/**\n *     canvas   \n * @param {Canvas} canvas\n * @param {double} scale\n * @param {Object} meta\n * @returns\n */\nconst fitByContain = (canvas, scale, meta) => {\n  const { canvasWidth, canvasHeight } = canvas;\n  const imageW = meta.width;\n  const imageH = meta.height;\n  const imgRatio = imageH / imageW;\n  const canvasRatio = canvasHeight / canvasWidth;\n  let ratio = 1;\n  if (canvasRatio <= imgRatio) {\n    // landscape\n    ratio = canvasHeight / imageH;\n  } else {\n    // portrait\n    ratio = canvasWidth / imageW;\n  }\n  return fitByOriginalSize(canvas, ratio, meta);\n};\n/**\n *     (      )\n * @param {Canvas} canvas\n * @param {double} scale\n * @param {width, height} meta\n * @returns\n */\nconst fitByCover = (canvas, scale, meta) => {\n  const { canvasWidth, canvasHeight } = canvas;\n  const imageW = meta.width;\n  const imageH = meta.height;\n  const imgRatio = imageH / imageW;\n  const canvasRatio = canvasHeight / canvasWidth;\n  let ratio = 1;\n  if (canvasRatio <= imgRatio) {\n    // landscape\n    ratio = canvasWidth / imageW;\n  } else {\n    // portrait\n    ratio = canvasHeight / imageH;\n  }\n  return fitByOriginalSize(canvas, ratio, meta);\n};\n/**\n *     ()\n * @param {Canvas} canvas\n * @param {double} ratio    ,  \n * @param {width, height} meta original image metadata(width, height etc)\n * @returns\n */\nconst fitByOriginalSize = (canvas, ratio, meta) => {\n  const { canvasWidth, canvasHeight } = canvas;\n  const x = (meta.width * ratio - canvasWidth) / 2;\n  const y = (meta.height * ratio - canvasHeight) / 2;\n  /*\n   * x, y, width, height in context of viewport(canvas) not of original image\n   */\n  const cvs = {\n    x: x,\n    y: y,\n    width: canvasWidth,\n    height: canvasHeight,\n    ratio\n  };\n  const image = {\n    x: cvs.x / ratio,\n    y: cvs.y / ratio,\n    width: cvs.width / ratio,\n    height: cvs.height / ratio\n  };\n  return { canvas: cvs, image };\n};\n\nconst scaling = {\n  cover: fitByCover,\n  contain: fitByContain,\n  none: fitByOriginalSize\n};\n/**\n * capture on viewport\n * @param {Canvas} canvas\n * @param {{x:number,y:number,width:number,height:number}} rect\n * @returns\n */\nconst captureOnViewport = (canvas, rect) => {\n  // capture on viewport\n  const imgData = canvas.ctx.getImageData(\n    rect.x,\n    rect.y,\n    rect.width,\n    rect.height\n  );\n  const copyCanvas = document.createElement('canvas');\n  copyCanvas.width = rect.width;\n  copyCanvas.height = rect.height;\n  copyCanvas.getContext('2d').putImageData(imgData, 0, 0);\n  return copyCanvas.toDataURL();\n};\n/**\n * capture on original image\n * @param {Canvas} canvas\n * @param {{x:number,y:number,width:number,height:number}} rect\n * @returns\n */\nconst captureOnImage = (canvas, rect) => {\n  // capture on image\n  const { viewport, source } = canvas.$$;\n  const { image } = viewport;\n  const { ratio } = viewport.canvas;\n  const scaledRect = {\n    x: rect.x / ratio + image.x,\n    y: rect.y / ratio + image.y,\n    width: rect.width / ratio,\n    height: rect.height / ratio\n  };\n  // const scaledRect = source.area;\n\n  const imgData = source.capture(scaledRect);\n  const copyCanvas = document.createElement('canvas');\n  /*\n   * width, height can be overflowed when scaling\n   */\n  copyCanvas.width = Math.min(source.meta.width, scaledRect.width);\n  copyCanvas.height = Math.min(source.meta.height, scaledRect.height);\n  copyCanvas.getContext('2d').putImageData(imgData, 0, 0);\n  return copyCanvas.toDataURL();\n};\n\nconst capturing = {\n  viewport: captureOnViewport,\n  image: captureOnImage\n};\n\nfunction DndHandler(canvas) {\n  // const { x: vx, y: vy } = canvas.$$.viewport;\n  let vx;\n  let vy;\n  return {\n    accept(el) {\n      return el === canvas.$$.canvasEl;\n    },\n    beforeDrag() {\n      vx = canvas.$$.viewport.canvas.x;\n      vy = canvas.$$.viewport.canvas.y;\n    },\n    dragging(ctx) {\n      canvas.$$.viewport.canvas.x = vx - ctx.dx;\n      canvas.$$.viewport.canvas.y = vy - ctx.dy;\n      canvas.repaint();\n    },\n    afterDrag() {\n      // update (x, y) of viewport.image\n      const { viewport } = canvas.$$;\n      const { ratio } = viewport.canvas;\n      viewport.image.x = viewport.canvas.x / ratio;\n      viewport.image.y = viewport.canvas.y / ratio;\n    }\n  };\n}\n\nclass ImageSource {\n  constructor(img, meta) {\n    this.image = img;\n    this.meta = meta;\n    this.$$ = {\n      canvas: null,\n      ctx: null\n    };\n    const origin = dom.tag.canvas();\n    origin.width = meta.width;\n    origin.height = meta.height;\n    const originCtx = origin.getContext('2d');\n    originCtx.drawImage(img, 0, 0);\n    this.$$.canvas = origin;\n    this.$$.ctx = originCtx;\n  }\n  /**\n   * capture image in the give rectangle\n   * @param {{x:number,y:number,width:number,height:number}} rect\n   * @returns ImageData\n   */\n  capture(rect) {\n    return this.$$.ctx.getImageData(rect.x, rect.y, rect.width, rect.height);\n  }\n}\nclass Canvas {\n  constructor(wrapperEl, config, eventBus) {\n    this.parentEl = wrapperEl;\n    this.config = config;\n    this.ctx = null;\n    this.$$ = {\n      viewport: null,\n      source: null\n    };\n    this.injectCanvas();\n    this.$$.dnd = new Dnd(new DndHandler(this));\n    this.eventBus = eventBus;\n    eventBus.on('config-updated', (config) => {\n      const { key } = config;\n      if (key === 'ratio' || key === 'fitMode' || key === 'captureOn') {\n        const { ratio, fitMode } = this.config;\n        this.$$.viewport = scaling[fitMode](this, ratio, this.$$.source.meta);\n        this.repaint();\n        this.eventBus.emit('viewport', this.$$.viewport);\n      }\n    });\n  }\n\n  injectCanvas() {\n    const canvasEl = dom.tag.canvas();\n    this.$$.canvasEl = canvasEl;\n    canvasEl.width = this.canvasWidth;\n    canvasEl.height = this.canvasHeight;\n    this.ctx = canvasEl.getContext('2d');\n    this.parentEl.appendChild(canvasEl);\n    this.repaint();\n  }\n\n  clearCanvas(ctx) {\n    ctx.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\n  }\n  copyImageAt(rect) {\n    const { captureOn } = this.config;\n    return capturing[captureOn](this, rect);\n  }\n\n  wrapperEl() {\n    return this.$$.wrapperEl;\n  }\n\n  renderImage(ctx) {\n    if (this.$$.source) {\n      const { image } = this.$$.source;\n\n      const { viewport } = this.$$;\n      const { ratio } = viewport.canvas;\n      const offsetX = viewport.canvas.x < 0 ? -viewport.canvas.x : 0;\n      const offsetY = viewport.canvas.y < 0 ? -viewport.canvas.y : 0;\n\n      ctx.drawImage(\n        image,\n        (viewport.canvas.x + offsetX) / ratio,\n        (viewport.canvas.y + offsetY) / ratio,\n        viewport.canvas.width / ratio,\n        viewport.canvas.height / ratio,\n        offsetX,\n        offsetY,\n        this.canvasWidth,\n        this.canvasHeight\n      );\n      // dom.imageSize(image);\n    }\n  }\n\n  setImage(img, meta) {\n    this.$$.source = new ImageSource(img, meta);\n    // this.$$.image = img;\n    // this.$$.meta = meta;\n    const { ratio, fitMode } = this.config;\n    this.$$.viewport = scaling[fitMode](this, ratio, meta);\n    this.eventBus.emit('viewport', this.$$.viewport);\n    this.repaint();\n  }\n\n  repaint() {\n    const { ctx } = this;\n    this.clearCanvas(ctx);\n    this.renderImage(ctx);\n  }\n\n  get canvasWidth() {\n    return resolveWidth(this.parentEl, this.config.width);\n  }\n\n  get canvasHeight() {\n    return this.config.height;\n  }\n\n  get image() {\n    return this.$$.source.image;\n  }\n}\nexport default Canvas;\n","/* eslint-disable no-param-reassign */\nimport dom from './dom';\nimport { Dnd } from './dnd';\n\nlet boxEl;\nconst drawRange = (el, selection, captureOn) => {\n  el.style.left = `${selection.x}px`;\n  el.style.top = `${selection.y}px`;\n  el.style.width = `${selection.width}px`;\n  el.style.height = `${selection.height}px`;\n  el.classList.remove('viewport');\n  el.classList.remove('image');\n  el.classList.add(captureOn);\n  /* if (editing) {\n    el.classList.add('editing');\n  } else {\n    el.classList.remove('editing');\n  } */\n};\nconst drawSize = (el, selection, fn) => {\n  const w = parseInt(selection.width, 10);\n  const h = parseInt(selection.height, 10);\n  // const textEl = el.querySelector('.size-text');\n  el.innerHTML = fn(w, h);\n};\nconst pos = {\n  x: 0,\n  y: 0,\n  parent: null\n};\nconst moveHandler = {\n  accept(el) {\n    const elem = dom.closest(el, '.btn-move');\n    return !!elem;\n  },\n  beforeDrag() {\n    pos.x = boxEl.offsetLeft;\n    pos.y = boxEl.offsetTop;\n    pos.width = boxEl.offsetWidth;\n    pos.height = boxEl.offsetHeight;\n    pos.parent = {\n      width: boxEl.parentElement.offsetWidth,\n      height: boxEl.parentElement.offsetHeight\n    };\n  },\n  dragging(ctx, { selection }) {\n    let left = Math.max(0, pos.x + ctx.dx);\n    let top = Math.max(0, pos.y + ctx.dy);\n    left = Math.min(left, pos.parent.width - pos.width);\n    top = Math.min(top, pos.parent.height - pos.height);\n    selection.selection.x = left;\n    selection.selection.y = top;\n    selection.repaint();\n    // boxEl.style.left = `${left}px`;\n    // boxEl.style.top = `${top}px`;\n  },\n  afterDrag() {\n    // console.log('[AFTER]', ctx);\n  }\n};\n\nfunction ResizeHandler(selection) {\n  let sw;\n  let sh;\n  return {\n    accept(el) {\n      const btn = dom.closest(el, '.btn-resizer');\n      // console.log('[ACCEPT] ', btn);\n      return btn === selection.$$.btnResize;\n    },\n    beforeDrag() {\n      sw = selection.selection.width;\n      sh = selection.selection.height;\n    },\n    dragging(ctx) {\n      selection.selection.width = sw + ctx.dx;\n      selection.selection.height = sh + ctx.dy;\n      selection.repaint();\n    },\n    afterDrag() {\n      // console.log('[RESIZE] DONE');\n    }\n  };\n}\nclass Selection {\n  constructor(parentEl, config, eventBus) {\n    this.$$ = { parent: parentEl, editing: true };\n    this.config = config;\n    // this.selection = selection;\n    // this.ranges = ranges;\n    this.eventBus = eventBus;\n    boxEl = this.prepareEl();\n    this.setVisible(false);\n    this.dnd = new Dnd(moveHandler, { selection: this });\n    this.resizeDnd = new Dnd(new ResizeHandler(this));\n    this.repaint();\n    this.eventBus.on('config-updated', (config) => {\n      const { key, value } = config;\n      if (key === 'captureOn') {\n        this.repaint();\n      } else if (key === 'range') {\n        // this.setRange(value);\n        this.repaint();\n      }\n    });\n    this.eventBus.on('viewport', (vp) => {\n      console.log('[VIEWPORT]', vp);\n      this.repaint();\n    });\n  }\n  get selection() {\n    return this.config.range;\n  }\n  get ranges() {\n    return this.config.ranges;\n  }\n  get captureOn() {\n    return this.config.captureOn;\n  }\n\n  setVisible(visible) {\n    this.visible = visible;\n    const display = this.visible ? '' : 'none';\n    dom.css(this.$$.el, { display });\n  }\n  prepareEl() {\n    const { parent } = this.$$;\n    const div = dom.tag.div('.selection .editing .viewport');\n    this.$$.el = div;\n    /* dom.event.click(\n      div,\n      (e) => {\n        e.stopPropagation();\n        this.toggleEditing();\n      },\n      { stop: true }\n    ); */\n    /* move button */\n    const button = dom.tag.iconButton(\n      '.btn-move .btn-icon',\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><path d=\"M0 0h24v24H0V0z\" fill=\"none\"/><path d=\"M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z\"/></svg>'\n    );\n    dom.event.consume(button, 'click');\n    div.appendChild(button);\n    parent.appendChild(div);\n\n    /* resize button */\n    const btnResize = dom.tag.iconButton(\n      '.btn-icon .btn-resizer',\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" enable-background=\"new 0 0 24 24\" height=\"18px\" viewBox=\"0 0 24 24\" width=\"18px\" fill=\"currentColor\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><g/><polygon points=\"13,6.99 16,6.99 12,3 8,6.99 11,6.99 11,17.01 8,17.01 12,21 16,17.01 13,17.01\"/></g></svg>'\n    );\n    div.appendChild(btnResize);\n    this.$$.btnResize = btnResize;\n\n    /* size box */\n    const sizeDiv = dom.tag.div('.size-box .box');\n    this.$$.sizeEl = sizeDiv;\n    this.$$.sizeText = dom.tag.span('.size-text');\n    sizeDiv.appendChild(this.$$.sizeText);\n    sizeDiv.appendChild(\n      dom.tag.iconButton(\n        '.btn-range-lock',\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"16px\" viewBox=\"0 0 24 24\" width=\"16px\" fill=\"currentColor\"><g fill=\"none\"><path d=\"M0 0h24v24H0V0z\"/><path d=\"M0 0h24v24H0V0z\" opacity=\".87\"/></g><path d=\"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm9 14H6V10h12v10zm-6-3c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2z\"/></svg>'\n      )\n    );\n    dom.event.click(this.$$.sizeText, (e) => {\n      e.stopPropagation();\n      this.eventBus.emit('sizebox', this.selection);\n    });\n    div.appendChild(sizeDiv);\n\n    /* area box */\n    // const areaBox =\n    const areaBox = (this.$$.areaEl = dom.tag.div('.area-box .box'));\n    const areaText = (this.$$.areaText = dom.tag.span('.area-text'));\n    areaBox.appendChild(areaText);\n    div.appendChild(areaBox);\n    return div;\n  }\n\n  /* toggleEditing() {\n    this.$$.editing = !this.$$.editing;\n    this.repaint();\n  } */\n\n  mergeSelection(selection) {\n    const { x, y, width, height } = selection;\n    this.selection.x = x || this.selection.x;\n    this.selection.y = y || this.selection.y;\n    this.selection.width = width || this.selection.y;\n    this.selection.height = height || this.selection.height;\n    this.repaint();\n  }\n\n  repaint() {\n    if (this.selection) {\n      drawRange(this.$$.el, this.selection, this.captureOn);\n      drawSize(this.$$.sizeText, this.selection, (w, h) => `${w} x ${h}`);\n\n      const ratio = this.captureOn === 'image' ? this.config.ratio : 1;\n      drawSize(\n        this.$$.areaText,\n        this.selection,\n        (w, h) => `${parseInt(w / ratio)} x ${parseInt(h / ratio)}`\n      );\n    }\n  }\n}\nexport default Selection;\n","import dom from './dom';\n\nconst template = {\n  wrapper: `<div class=\"range-bg\">\n    <div class=\"range-box\">\n      <h3></h3>\n      <div class=\"range-input\">\n        <input type=\"text\" placeholder=\"ex) 600 400\" data-range-input>\n        <button data-range-add>ADD</button>\n      </div>\n      <ul class=\"range-list\">\n      </ul>\n      <div class=\"footer\">\n        <button data-range-close>CLOSE</button>\n      </div>\n    </div>\n  </div>`,\n  range: '<li class=\"range\" data-w=\"@w\" data-h=\"@h\"><span>@text</span></li>'\n};\nlet wrapper;\nlet ranges;\nlet bus;\nconst close = () => {\n  wrapper.remove();\n};\nconst renderOptions = () => {\n  const ul = dom.findOne(wrapper, '.range-list');\n  ul.replaceChildren();\n  ranges.options.forEach((option, idx) => {\n    const { width: w, height: h } = option;\n    const text = `${w}x${h}`;\n    const li = dom.parseTemplate(template.range, { text, w, h });\n    if (idx === ranges.active) {\n      li.classList.add('active');\n    }\n    ul.appendChild(li);\n  });\n};\nconst installListener = () => {\n  dom.event.click(wrapper, (e) => {\n    const { target } = e;\n    dom.is(target, 'li.range', (li) => {\n      const data = dom.data.int(li, ['w', 'h']);\n      const activeIndex = ranges.options.findIndex(\n        (r) => r.width === data.w && r.height === data.h\n      );\n      ranges.active = activeIndex;\n      renderOptions();\n      bus.emit('range', {\n        range: {\n          width: data.w,\n          height: data.h\n        },\n        active: activeIndex,\n        save: false\n      });\n    });\n    dom.is(target, '[data-range-add]', () => {\n      const input = dom.findOne(wrapper, '[data-range-input]');\n      const [width, height] = input.value\n        .split(' ')\n        .map((t) => parseInt(t, 10));\n      const range = { width, height };\n      ranges.options.push(range);\n      const activeIndex = ranges.options.length - 1;\n      ranges.active = activeIndex;\n      renderOptions();\n      bus.emit('range', {\n        range,\n        active: activeIndex,\n        save: true\n      });\n    });\n    dom.is(target, '[data-range-close]', () => {\n      close();\n    });\n  });\n};\n\nconst showRangeBox = (eventBus, parentEl, selection, _ranges) => {\n  bus = eventBus;\n  ranges = _ranges;\n  const el = dom.parseTemplate(template.wrapper, {});\n  wrapper = el;\n  console.log(el);\n  renderOptions(ranges);\n  parentEl.appendChild(wrapper);\n  installListener();\n};\n\nexport default {\n  showRangeBox,\n  close\n};\n","\n      import API from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./photoflex.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./photoflex.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","import dom from './dom';\nimport Canvas from './canvas';\nimport Selection from './selection';\nimport rangebox from './rangebox';\nimport './photoflex.scss';\n\nconst captureFormatter = {\n  image: (data) => {\n    const img = new Image();\n    img.src = data;\n    return img;\n  },\n  dataUrl: (data) => data\n};\nclass PhotoFlex {\n  constructor(canvas, selection, el, bus) {\n    this.canvas = canvas;\n    this.selection = selection;\n    this.$$ = { ...el };\n\n    this.eventBus = bus;\n\n    this.eventBus.on('sizebox', (size) => {\n      rangebox.showRangeBox(\n        this.eventBus,\n        this.$$.rootWrapper,\n        size,\n        this.getConfig('ranges')\n      );\n    });\n    this.eventBus.on('range', (payload) => {\n      // console.log('[RANGE]', payload);\n      const { range, save } = payload;\n      this.selection.mergeSelection(range);\n      if (save) {\n        this.$$.config.ranges.push(`${range.width}x${range.height}`);\n      }\n    });\n  }\n\n  setConfig(key, value) {\n    const { config } = this.canvas;\n    if (!Object.prototype.hasOwnProperty.call(config, key)) {\n      throw new Error(`no such config [${key}]`);\n    }\n    config[key] = value;\n    this.eventBus.emit('config-updated', { key, value });\n  }\n\n  getConfig(key) {\n    return this.canvas.config[key];\n  }\n  /**\n   *\n   * @param {object} rectToCaputure {x,y,width,height} on canvas area\n   * @param {string} format return type ('image' | 'dataUrl')\n   * @returns {{image, type, meta}} tag &lt;img/> if format === 'image', dataUrl else\n   */\n  capture(rectToCaputure, format) {\n    const rect = rectToCaputure || this.getConfig('range');\n    const dataURL = this.canvas.copyImageAt(rect);\n    // console.log(dataURL);\n    const comma = dataURL.indexOf(',');\n    /*\n     * base64_encoded_data = original_data * 1.33\n     * original_data       = base64_encoded_data * 0.75\n     */\n    const sizeInRealPic = parseInt((dataURL.length - (comma + 1)) * 0.75, 10);\n    const formatMode = format || 'image';\n    const img = captureFormatter[formatMode](dataURL);\n    return {\n      image: img,\n      type: formatMode,\n      meta: {\n        size: sizeInRealPic,\n        ...rectToCaputure\n      }\n    };\n  }\n\n  setRange(range) {\n    this.setConfig('range', range);\n  }\n  /**\n   * render image file into canvas. fileSource should be type of File\n   * @param {File} fileSource image file(which is selected from input[type=file])\n   * @returns {Promise}\n   */\n  openImage(fileSource) {\n    return dom.fileToImage(fileSource).then((fileMeta) => {\n      console.log(fileMeta);\n      const { file, img } = fileMeta;\n      const meta = {\n        size: file.size,\n        type: file.type,\n        width: img.width,\n        height: img.height\n      };\n      this.canvas.setImage(fileMeta.img, meta);\n      this.selection.setVisible(true);\n      return meta;\n    });\n  }\n}\nconst validate = (config) => !config;\nconst init = (userConfig) => {\n  const config = {\n    ratio: 1.0,\n    width: 400,\n    height: 400,\n    fitMode: 'none',\n    captureOn: 'viewport',\n    ranges: {\n      options: ['100x100', '200x200', '300x300'],\n      active: 1\n    },\n    range: {\n      x: 30,\n      y: 30,\n      width: 100,\n      height: 100\n    }\n  };\n  Object.assign(config, userConfig);\n  if (validate(config)) {\n    alert('error');\n  }\n\n  // inflate range options\n  const { ranges } = config;\n  const toInt = (v) => parseInt(v, 10);\n  const options = ranges.options.map((r) => {\n    const [width, height] = r.split('x').map(toInt);\n    return { width, height };\n  });\n  ranges.options = options;\n  const activeRange = ranges.options[ranges.active];\n  config.range.width = activeRange.width;\n  config.range.height = activeRange.height;\n\n  const wrapper = document.querySelector(config.el);\n  const canvasWrapper = dom.tag.div('.canvas-wrapper');\n  dom.css(canvasWrapper, { width: config.width, height: config.height });\n  wrapper.appendChild(canvasWrapper);\n\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      const eventBus = dom.event.createEventBus();\n      const canvas = new Canvas(canvasWrapper, config, eventBus);\n      const selection = new Selection(\n        canvasWrapper,\n        config,\n        // config.range,\n        // config.ranges,\n        eventBus\n      );\n      const instance = new PhotoFlex(\n        canvas,\n        selection,\n        {\n          rootWrapper: wrapper,\n          canvasWrapper,\n          config\n        },\n        eventBus\n      );\n      if (config.image) {\n        dom.tag.img(config.image).then((meta) => {\n          instance.setImage(meta.img, meta);\n        });\n      }\n      resolve(instance);\n    }, 0);\n  });\n};\nexport { init };\nexport default { init };\n"],"sourceRoot":""}